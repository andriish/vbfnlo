cirb ---------------------------------------------------------------
cirb
cirb        leptonic tensors for the process p p > a a j j
cirb
cirb ---------------------------------------------------------------
      
c ------------------------------------------------------------------------------
c
c       quadruple vertex: w+ w- > a a
c
c ------------------------------------------------------------------------------

        subroutine wwtoaa_anomal(q1, q2, h, ww)
	
          IMPLICIT NONE

         REAL*8 Q1(0:3), Q2(0:3)
         complex*16 ww(0:3,0:3)
         integer lsign(3:6,4),ll,h
        ! possible lepton helicities:
         data (lsign(ll,1),ll=3,6) / -1, -1, -1, -1/  !h=1
         data (lsign(ll,2),ll=3,6) / -1, -1,  1,  1/  !h=2
         data (lsign(ll,3),ll=3,6) /  1,  1, -1, -1/  !h=3
         data (lsign(ll,4),ll=3,6) /  1,  1,  1,  1/  !h=4
	

            call wwtoaa1_anomal(q1, q2,lsign(3,h) ,ww(0,0))

        end subroutine wwtoaa_anomal

c--------------------------------------------------------------------

        subroutine wwtoaa1_anomal(q1, q2, lsign, ww)

C     
C     Generated by MadGraph5_aMC@NLO v. 2.1.2, 2014-07-03
C     By the MadGraph5_aMC@NLO Development Team
C     Visit launchpad.net/madgraph5 and amcatnlo.web.cern.ch
C     
C     Returns amplitude squared summed/avg over colors
C     for the point with external lines W(0:6,NEXTERNAL)
C     
C     Process: w+ w- > a WEIGHTED=2
C     
      IMPLICIT NONE
C     
C     CONSTANTS
C     
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=4)
      INTEGER    NWAVEFUNCS,     NCOLOR
      PARAMETER (NWAVEFUNCS=6, NCOLOR=1)
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C     
C     ARGUMENTS 
C
        real*8 :: q1(0:3), q2(0:3)
        integer lsign(3:6)
        complex*16 ww(0:3, 0:3)
        integer :: i
C     
C     LOCAL VARIABLES 
C     
      INTEGER mu, nu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C     
C     GLOBAL VARIABLES
C

#include "tensorz.inc"
#include "VBFNLO/utilities/coupl.inc"
    
        logical lswitch
        parameter (lswitch = .true.)
    

C     ----------
C     BEGIN CODE
C     ----------

        if (lswitch) then
            do i = 1, 6
                w(i, 3) = ae(i)
                w(i, 4) = au(i)
            end do
        end if
        
    
        do mu = 0, 3
            do nu = 0, 3
               !incoming particles
                call vcartx(q1(0), wmass, wwidth, mu, -1, w(1, 1))
                call vcartx(q2(0), wmass, wwidth, nu, -1, w(1, 2))

C               Amplitude(s) for diagram number 1
                call wwaa_anomal4(w(1,1), w(1,3), w(1,2), w(1,4), amp(1))
                call jwpawm_anomal3(w(1,3),w(1,1), w(1,5))
C               Amplitude(s) for diagram number 2
                call wwa_anomal3(w(1,5),w(1,2),w(1,4), amp(2))
                call jwpawm_anomal3(w(1,4), w(1,1), w(1,5))
C               Amplitude(s) for diagram number 3
                call wwa_anomal3(w(1,5), w(1,2), w(1,3), amp(3))

               !new higgs topology

                call jhww_anomal3(W(1,1),W(1,2),W(1,6))
                call aah_anomal3(W(1,3),W(1,4),W(1,6),amp(4))
 
                ww(mu, nu) = +AMP(1)+AMP(2)+AMP(3)+amp(4) 

            end do
        end do
        end subroutine wwtoaa1_anomal

      subroutine calc_wwtoa2_anomal(idb,iu,qu,phtn,Q,wwtoa1)
C  Input:   Q(*)        one of the two incoming boson momenta 
c           idb = 1      Q = q1 = W+ momentum
c           idb = 2      Q = q2 = W- momentum
c  OUPTPUT: wwtoa1(mu,nu)  lepton tensor for w w--> A 
C  
C Generated by MadGraph II                                              
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : w- w+ -> a  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   1)
      INTEGER    NWAVEFUNCS   
      PARAMETER (NWAVEFUNCS=   3)
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)

C  
C ARGUMENTS 
C  
      REAL*8 Q(0:3)
      complex*16 wwtoa1(0:3,0:3)
      integer idb
      integer iu
  
C LOCAL VARIABLES 
C  
      INTEGER I,MU,NU
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(18,NWAVEFUNCS)
      real*8 Q1(0:3), Q2(0:3), qu(0:3)
      complex*16 phtn(6)
c  A polarization vector
!#include "tensorw.inc"      
#include "VBFNLO/utilities/coupl.inc"

C
C ----------
C BEGIN CODE
C ----------

      if (idb.eq.1) then
         do mu = 0,3
            q1(mu)  = q(mu)
	        q2(mu)  = qu(mu)-q(mu)
         enddo
      elseif (idb.eq.2) then
         do mu = 0,3
            q2(mu)  = q(mu)
            q1(mu)  = qu(mu)-q(mu)
         enddo
      endif


      do i = 1,6
         w(i,3) = phtn(i)
      enddo

      DO MU = 0,3
         DO NU = 0,3

            CALL VCARTX(q1(0),WMASS ,WWIDTH,MU,-1,W(1,1   ))       
            CALL VCARTX(q2(0),WMASS ,WWIDTH,NU,-1,W(1,2   ))          
            call wwa_anomal3(w(1,1),w(1,2),w(1,3), amp(1))
            wwtoa1(MU,NU) = +AMP(   1)
         Enddo !NU
      Enddo !MU
      END

      subroutine vvtoaa_anomal(q1,q2,h,aa,az,za,zz)
	
      IMPLICIT NONE

      REAL*8 Q1(0:3), Q2(0:3)
      complex*16 aa(0:3,0:3)
      complex*16 az(0:3,0:3)
      complex*16 za(0:3,0:3)

      complex*16 zz(0:3,0:3)
      integer lsign(3:6,4),h,ll

	! possible lepton helicities:
	data (lsign(ll,1),ll=3,6) / -1, -1, -1, -1/
	data (lsign(ll,2),ll=3,6) / -1, -1,  1,  1/
	data (lsign(ll,3),ll=3,6) /  1,  1, -1, -1/
	data (lsign(ll,4),ll=3,6) /  1,  1,  1,  1/

	call AAtoAA1_anomal(q1,q2,lsign(3,h),aa(0,0))
	call ZAtoAA1_anomal(q1,q2,lsign(3,h),az(0,0))
	call ZAtoAA1_anomal(q2,q1,lsign(3,h),za(0,0))
	call ZZtoAA1_anomal(q1,q2,lsign(3,h),zz(0,0))
		
	end
	      
       subroutine ZZtoAA1_anomal(q1,q2,lsign,zz)
C     
C     Generated by MadGraph5_aMC@NLO v. 2.1.2, 2014-07-03
C     By the MadGraph5_aMC@NLO Development Team
C     Visit launchpad.net/madgraph5 and amcatnlo.web.cern.ch
C     
C     Process: z z > e+ e- a QCD=0
C     
      IMPLICIT NONE
C     
C     CONSTANTS
C     
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=4)
      INTEGER    NWAVEFUNCS
      PARAMETER (NWAVEFUNCS=7)
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C     
C     ARGUMENTS 
C     
      REAL*8 Q1(0:3),Q2(0:3)
      INTEGER lsign(3:6)
      COMPLEX*16 zz(0:3,0:3)
C     
C     LOCAL VARIABLES 
C     
      INTEGER I,MU,NU
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C     
C     GLOBAL VARIABLES
C     
#include "tensorz.inc"
#include "VBFNLO/utilities/coupl.inc"

      logical lswitch
      parameter (lswitch=.true.)  

C     ----------
C     BEGIN CODE
C     ----------

      if (lswitch) then
        do i = 1,6
	   w(i,3) = ae(i) 
	   w(i,4) = au(i)
      	enddo
      else
      endif
      
      DO MU = 0,3
        DO NU = 0,3

      CALL VCARTX(Q1(0),ZMASS,ZWIDTH, MU,-1,W(1,1))        
      CALL VCARTX(Q2(0),ZMASS,ZWIDTH, NU,-1,W(1,2))

      call aazz_anomal4(W(1,3),W(1,4),W(1,1),W(1,2),amp(1))
      
c     Higgs contributions
      
      !canal s
      call jhzz_anomal3(W(1,1),W(1,2),W(1,5))
      call aah_anomal3(W(1,3),W(1,4),W(1,5),amp(2))

      !canal t
      call jhaz_anomal3(W(1,3),W(1,1),W(1,5))
      call azh_anomal3(W(1,4),W(1,2),W(1,5),amp(3))

      !canal u
      call jhaz_anomal3(W(1,3),W(1,2),W(1,5))
      call azh_anomal3(W(1,4),W(1,1),W(1,5),amp(4))
      
      zz(MU,NU)=AMP(1)+amp(2)+amp(3)+amp(4)

        ENDDO
      ENDDO

      END
       subroutine ZAtoAA1_anomal(q1,q2,lsign,za)
C     
C     Generated by MadGraph5_aMC@NLO v. 2.1.2, 2014-07-03
C     By the MadGraph5_aMC@NLO Development Team
C     Visit launchpad.net/madgraph5 and amcatnlo.web.cern.ch
C     
C     Process: z z > e+ e- a QCD=0
C     
      IMPLICIT NONE
C     
C     CONSTANTS
C     
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=4)
      INTEGER    NWAVEFUNCS
      PARAMETER (NWAVEFUNCS=7)
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C     
C     ARGUMENTS 
C     
      REAL*8 Q1(0:3),Q2(0:3)
      INTEGER lsign(3:6)
      COMPLEX*16 za(0:3,0:3)
C     
C     LOCAL VARIABLES 
C     
      INTEGER I,MU,NU
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C     
C     GLOBAL VARIABLES
C     
#include "tensorz.inc"
#include "VBFNLO/utilities/coupl.inc"

      logical lswitch
      parameter (lswitch=.true.)  

C     ----------
C     BEGIN CODE
C     ----------

      if (lswitch) then
        do i = 1,6
	   w(i,3) = ae(i) 
	   w(i,4) = au(i)
      	enddo
      else
      endif
      
      DO MU = 0,3
        DO NU = 0,3

      CALL VCARTX(Q1(0),ZERO,ZERO, MU,-1,W(1,1))        
      CALL VCARTX(Q2(0),ZMASS,ZWIDTH, NU,-1,W(1,2))

      call aaaz_anomal4(W(1,3),W(1,4),W(1,1),W(1,2),amp(1))
      
c     Higgs contributions
      
      !canal s
      call jhaz_anomal3(W(1,1),W(1,2),W(1,5))
      call aah_anomal3(W(1,3),W(1,4),W(1,5),amp(2))

      !canal t
      call jhaa_anomal3(W(1,1),W(1,3),W(1,5))
      call azh_anomal3(W(1,4),W(1,2),W(1,5),amp(3))

      !canal u
      call jhaz_anomal3(W(1,3),W(1,2),W(1,5))
      call aah_anomal3(W(1,1),W(1,4),W(1,5),amp(4))
      
      
      za(MU,NU)=AMP(1)+amp(2)+amp(3)+amp(4)

        ENDDO
      ENDDO

      END
       subroutine AAtoAA1_anomal(q1,q2,lsign,aa)
C     
C     Generated by MadGraph5_aMC@NLO v. 2.1.2, 2014-07-03
C     By the MadGraph5_aMC@NLO Development Team
C     Visit launchpad.net/madgraph5 and amcatnlo.web.cern.ch
C     
C     Process: z z > e+ e- a QCD=0
C     
      IMPLICIT NONE
C     
C     CONSTANTS
C     
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=4)
      INTEGER    NWAVEFUNCS
      PARAMETER (NWAVEFUNCS=7)
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C     
C     ARGUMENTS 
C     
      REAL*8 Q1(0:3),Q2(0:3)
      INTEGER lsign(3:6)
      COMPLEX*16 aa(0:3,0:3)
C     
C     LOCAL VARIABLES 
C     
      INTEGER I,MU,NU
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C     
C     GLOBAL VARIABLES
C     
#include "tensorz.inc"
#include "VBFNLO/utilities/coupl.inc"

      logical lswitch
      parameter (lswitch=.true.)  

C     ----------
C     BEGIN CODE
C     ----------

      if (lswitch) then
        do i = 1,6
	   w(i,3) = ae(i) 
	   w(i,4) = au(i)
      	enddo
      else
      endif
      
      DO MU = 0,3
        DO NU = 0,3

      CALL VCARTX(Q1(0),ZERO,ZERO, MU,-1,W(1,1))        
      CALL VCARTX(Q2(0),ZERO,ZERO, NU,-1,W(1,2))

      call aaaa_anomal4(W(1,3),W(1,4),W(1,1),W(1,2),amp(1))
      
c     Higgs contributions
      
      !canal s
      call jhaa_anomal3(W(1,1),W(1,2),W(1,5))
      call aah_anomal3(W(1,3),W(1,4),W(1,5),amp(2))

      !canal t
      call jhaa_anomal3(W(1,1),W(1,3),W(1,5))
      call aah_anomal3(W(1,2),W(1,4),W(1,5),amp(3))
      
      !canal u
      call jhaa_anomal3(W(1,1),W(1,4),W(1,5))
      call aah_anomal3(W(1,2),W(1,3),W(1,5),amp(4))
      
      
      aa(MU,NU)=AMP(1)+amp(2)+amp(3)+amp(4)

        ENDDO
      ENDDO

      END

